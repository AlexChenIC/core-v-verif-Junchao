# corev-dv - CORE-V RISC-V 随机指令生成器

此目录包含 core-v-verif 对 [riscv-dv](https://github.com/google/riscv-dv) 的扩展。来自 Google 的克隆代码未在本地修改，我们尽可能尝试使用 Google 的最新稳定版本。任何 core-v-verif 专用功能都作为特定 SV 类的替换（如清单）或扩展来实现。

## 📁 目录结构和用途

### 🎯 设计理念
- **非侵入式扩展**：不修改原始 Google riscv-dv 代码
- **继承式增强**：通过扩展和替换实现 CV32E40P 专用功能
- **版本同步**：保持与 Google 最新稳定版本的同步

### 📂 文件组织
- **克隆的 Google 代码**：保持原始结构和功能
- **CORE-V 专用扩展**：针对 CV32E40P 的定制化功能
- **配置文件**：清单和配置替换文件

## 🔄 输出和日志管理

编译日志、运行时日志和生成的程序放置在此处，使用与 riscv-dv 相同的 `out_<YYYY_MM_DD>` 目录格式。

### 📝 日志类型：
- **编译日志**：随机指令生成器编译过程记录
- **运行时日志**：测试生成和执行日志
- **生成程序**：随机生成的汇编语言测试程序

### 🎯 TODO 项目
重新定向生成的汇编语言测试程序到中央位置。

**目标：**
- 统一管理生成的测试程序
- 便于测试程序的重用和分析
- 改善目录结构组织

## 🔧 与 UVM 环境的集成

core-v-verif 中的 UVM 环境**不使用** `run.py` Python 脚本来运行生成器（尽管没有进行阻止您这样做的更改）。

### 🛠️ 使用方式
查看相应的 Makefile（例如 `$PROJ_ROOT/cv32/sim/uvmt_cv32/Makefile`）了解 core-v-verif 如何运行生成器的示例。

**核心特点：**
- **Makefile 驱动**：通过 Makefile 集成到验证流程
- **UVM 兼容**：与 UVM 验证环境无缝集成
- **自动化生成**：作为验证流程的一部分自动生成随机测试

## 🎲 随机指令生成功能

### 🔀 支持的随机化
- **指令序列随机化**：生成各种指令组合
- **操作数随机化**：随机寄存器和立即数值
- **控制流随机化**：随机分支和跳转模式
- **内存访问模式**：随机化内存访问行为

### 🎯 CV32E40P 专用特性
- **Xpulp 指令支持**：扩展 PULP 特殊指令
- **中断测试**：随机中断注入
- **异常处理**：异常条件测试
- **调试功能**：调试模式测试

## 🚀 快速开始指南

### 基本使用
```bash
# 进入仿真目录
cd $CORE_V_VERIF/cv32e40p/sim/uvmt

# 运行随机指令测试
make corev-dv

# 指定测试数量
make corev-dv TEST_NUM=100
```

### 高级配置
```bash
# 使用特定配置
make corev-dv CFG=my_config

# 启用特定指令类型
make corev-dv ENABLE_XPULP=1

# 生成中断测试
make corev-dv ENABLE_INTERRUPT=1
```

## 🔧 配置和定制

### 📋 配置选项
- **指令集配置**：选择要测试的 RISC-V 扩展
- **测试长度**：控制生成程序的复杂度
- **随机种子**：确保测试的可重现性
- **专用功能**：启用 CV32E40P 特定功能

### 🎨 扩展开发
如果需要为 CV32E40P 添加新的随机化功能：

1. **创建扩展类**：继承相应的 riscv-dv 基类
2. **添加专用配置**：修改配置文件
3. **集成到 Makefile**：更新构建流程
4. **测试和验证**：确保新功能正常工作

## 🔗 相关资源

### 📚 上游项目
- **[Google riscv-dv](https://github.com/google/riscv-dv)** - 原始随机指令生成器
- **[RISC-V 指令集规范](https://riscv.org/specifications/)** - 指令集标准

### 🛠️ CORE-V 验证环境
- **[UVM 环境](../README_ZH.md)** - 主验证环境
- **[仿真指南](../../sim/README_ZH.md)** - 仿真环境设置
- **[Makefile 指南](../../../mk/README_ZH.md)** - 详细构建说明
- **[学习中心](../../docs/learning-center/README.md)** - 完整学习资源

## 💡 使用技巧

### 🎯 有效的随机测试策略
1. **分层测试**：从简单到复杂逐步增加随机化程度
2. **种子管理**：保存有趣测试用例的随机种子
3. **覆盖率分析**：结合覆盖率数据指导随机测试
4. **问题重现**：使用固定种子重现发现的问题

### 🔍 调试随机测试
1. **日志分析**：仔细分析生成器和仿真日志
2. **程序检查**：检查生成的汇编程序
3. **增量调试**：逐步缩小问题范围
4. **环境隔离**：在简化环境中重现问题

---

*📝 本文档是 README.md 的中文翻译版本，详细说明了 corev-dv 随机指令生成器的使用方法和集成策略。*